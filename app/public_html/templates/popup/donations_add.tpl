<div class="modal-dialog modal-xl" role="document">
    <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title">Buy licenses</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
            <div class="card-body">
                <div class="container-xl">
                    <div id="donations_add__list" class="row row-cards">
                        <div class="col-sm-6 col-lg-3">
                            <div class="card card-md">
                                <div class="card-body text-center">
                                    <div class="text-uppercase text-muted font-weight-medium">Free</div>
                                    <div class="display-5 fw-bold my-3">$0</div>
                                    <ul class="list-unstyled lh-lg">
                                        <li><strong>3</strong> Users</li>
                                        <li>
                                            <!-- Download SVG icon from http://tabler-icons.io/i/check -->
                                            <svg xmlns="http://www.w3.org/2000/svg" class="icon me-1 text-success" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                                <path d="M5 12l5 5l10 -10"></path>
                                            </svg>
                                            Sharing Tools
                                        </li>
                                        <li>
                                            <!-- Download SVG icon from http://tabler-icons.io/i/x -->
                                            <svg xmlns="http://www.w3.org/2000/svg" class="icon me-1 text-danger" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                                <line x1="18" y1="6" x2="6" y2="18"></line>
                                                <line x1="6" y1="6" x2="18" y2="18"></line>
                                            </svg>
                                            Design Tools
                                        </li>
                                        <!--<li>
                                            <svg xmlns="http://www.w3.org/2000/svg" class="icon me-1 text-danger" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                                <line x1="18" y1="6" x2="6" y2="18"></line>
                                                <line x1="6" y1="6" x2="18" y2="18"></line>
                                            </svg>
                                            Private Messages
                                        </li>
                                        <li>
                                            <svg xmlns="http://www.w3.org/2000/svg" class="icon me-1 text-danger" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                                <line x1="18" y1="6" x2="6" y2="18"></line>
                                                <line x1="6" y1="6" x2="18" y2="18"></line>
                                            </svg>
                                            Twitter API
                                        </li>-->
                                    </ul>
                                    <div class="text-center mt-4">
                                        <a href="#" class="btn w-100">Choose plan</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6 col-lg-3">
                            <div class="card card-md">
                                <div class="ribbon ribbon-top ribbon-bookmark bg-green">
                                    <!-- Download SVG icon from http://tabler-icons.io/i/star -->
                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-filled" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                        <path d="M12 17.75l-6.172 3.245l1.179 -6.873l-5 -4.867l6.9 -1l3.086 -6.253l3.086 6.253l6.9 1l-5 4.867l1.179 6.873z"></path>
                                    </svg>
                                </div>
                                <div class="card-body text-center">
                                    <div class="text-uppercase text-muted font-weight-medium">Premium</div>
                                    <div class="display-5 fw-bold my-3">$49</div>
                                    <ul class="list-unstyled lh-lg">
                                        <li><strong>10</strong> Users</li>
                                        <li>
                                            <!-- Download SVG icon from http://tabler-icons.io/i/check -->
                                            <svg xmlns="http://www.w3.org/2000/svg" class="icon me-1 text-success" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                                <path d="M5 12l5 5l10 -10"></path>
                                            </svg>
                                            Sharing Tools
                                        </li>
                                        <li>
                                            <!-- Download SVG icon from http://tabler-icons.io/i/check -->
                                            <svg xmlns="http://www.w3.org/2000/svg" class="icon me-1 text-success" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                                <path d="M5 12l5 5l10 -10"></path>
                                            </svg>
                                            Design Tools
                                        </li>
                                    </ul>
                                    <div class="text-center mt-4">
                                        <a href="#" class="btn btn-green w-100">Choose plan</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="card card-md">
                                <div class="card-body">
                                    <div class="row align-items-center">
                                        <div class="col">
                                            <h2 class="h3">Other options?</h2>
                                            <p class="m-0 text-muted">If you prefer, just click on <b>customize choice</b> to be able to purchase licenses with other values.</p>
                                        </div>
                                        <div class="col-auto">
                                            <a href="#" class="btn btn-primary /w-100*/">
                                                Customize choice
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            {{{tmp.el__buttons}}}
            <a href="#" class="btn" data-bs-dismiss="modal">
                Close
            </a>
        </div>
    </div>
</div>

<script type="text/javascript">
    function donationsAddGetAll() {
        var donationsActive = false;
        
        document.getElementById("donations_add__list").innerHTML = 
              '<div class="empty">'
            + '    <p class="empty-title"><div class="spinner-grow" role="status"></div></p>'
            + '</div>';
        
        $.ajax({
            type: 'GET',
            url: CFG__API_URL + CFG__API_VERSION + "/wallet/resume",
            data: {},
            beforeSend: function (xhr){ 
                xhr.setRequestHeader('Authorization', cookieGet('__utmo'));
            },
            success: function(response) {
                if (response.success === true) {
                    var _data = response.data;
                    
                    $.ajax({
                        type: 'GET',
                        url: CFG__API_URL + CFG__API_VERSION + "/donations_model?status=active",
                        data: {},
                        beforeSend: function (xhr){ 
                            xhr.setRequestHeader('Authorization', cookieGet('__utmo'));
                        },
                        success: function(response2) {
                            if (response2.success === true) {
                                var arr = response2.data;
                                var html = '';
                                
                                if (arr.length > 0) {
                                    for (var i = 0; i < arr.length; i++){
                                        var id = arr[i]._id,
                                            amount = fmtMoney(arr[i]._amount),
                                            income = fmtMoney(arr[i]._income);
                                        
                                        var cssOptions = 'opacity: 0.5;pointer-events: none;';
                                        if (parseFloat(justNumber(_data._total)/100.0) >= parseFloat(justNumber(arr[i]._amount)/100.0)) {
                                            cssOptions = '';
                                            donationsActive = true;
                                        }
                                        
                                        html += 
                                              '<div class="col-sm-6 col-lg-3" style="'+cssOptions+'">'
                                            + '    <div class="card card-md">'
                                            + '        <div class="card-body text-center">'
                                            + '            <div class="text-uppercase text-muted font-weight-medium">' + arr[i]._name + '</div>'
                                            + '            <div class="display-5 fw-bold my-3">#' + arr[i]._contracts + '</div>'
                                            + '            <ul class="list-unstyled lh-lg">'
                                            + '                <li><strong>Advantages</strong>:</li>'
                                            + '                <li>'
                                            + '                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-currency-dollar" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">'
                                            + '                       <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>'
                                            + '                       <path d="M16.7 8a3 3 0 0 0 -2.7 -2h-4a3 3 0 0 0 0 6h4a3 3 0 0 1 0 6h-4a3 3 0 0 1 -2.7 -2"></path>'
                                            + '                       <path d="M12 3v3m0 12v3"></path>'
                                            + '                    </svg>'
                                            + '                    ' + amount
                                            + '                </li>'
                                            + '                <li>'
                                            + '                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-currency-dollar-singapore" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">'
                                            + '                       <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>'
                                            + '                       <path d="M21 6h-4a3 3 0 0 0 0 6h1a3 3 0 0 1 0 6h-4"></path>'
                                            + '                       <path d="M10 6h-4a3 3 0 1 0 0 6h1a3 3 0 0 1 0 6h-4"></path>'
                                            + '                       <path d="M17 20v-2"></path>'
                                            + '                       <path d="M18 6v-2"></path>'
                                            + '                    </svg>'
                                            + '                    ' + income
                                            + '                </li>'
                                            //                <!--<li>
                                            //                    <svg xmlns="http://www.w3.org/2000/svg" class="icon me-1 text-danger" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                            //                        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                            //                        <line x1="18" y1="6" x2="6" y2="18"></line>
                                            //                        <line x1="6" y1="6" x2="18" y2="18"></line>
                                            //                    </svg>
                                            //                    Private Messages
                                            //                </li>
                                            //                <li>
                                            //                    <svg xmlns="http://www.w3.org/2000/svg" class="icon me-1 text-danger" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                            //                        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                            //                        <line x1="18" y1="6" x2="6" y2="18"></line>
                                            //                        <line x1="6" y1="6" x2="18" y2="18"></line>
                                            //                    </svg>
                                            //                    Twitter API
                                            //                </li>-->
                                            + '            </ul>'
                                            + '            <div class="text-center mt-4">'
                                            + '                <a id="acquire--'+arr[i]._contracts+'" href="javascript:;" onclick="donations_add__New('+arr[i]._contracts+');" class="btn btn-primary w-100">'
                                            + '                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>'
                                            + '                    Buy licenses'
                                            + '                </a>'
                                            + '            </div>'
                                            + '        </div>'
                                            + '    </div>'
                                            + '</div>';
                                    }
                                    
                                    html +=
                                          '<div class="col-12">'
                                        + '    <div class="card card-md">'
                                        + '        <div class="card-body">'
                                        + '            <div class="row align-items-center">'
                                        + '                <div class="col">'
                                        + '                    <h2 class="h3">Outras opções?</h2>'
                                        + '                    <p class="m-0 text-muted">If you prefer, just click on <b>customize choice</b> to be able to purchase licenses with other values.</p>'
                                        + '                </div>'
                                        + '                <div class="col-auto">'
                                        + '                    <a href="javascript:;" onclick="dialogClose();View.openFormDonationsCustomAdd();" class="btn btn-primary /w-100*/">'
                                        + '                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-dots-circle-horizontal" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">'
                                        + '                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>'
                                        + '                            <circle cx="12" cy="12" r="9"></circle>'
                                        + '                            <line x1="8" y1="12" x2="8" y2="12.01"></line>'
                                        + '                            <line x1="12" y1="12" x2="12" y2="12.01"></line>'
                                        + '                            <line x1="16" y1="12" x2="16" y2="12.01"></line>'
                                        + '                        </svg>'
                                        + '                        Customize choice'
                                        + '                    </a>'
                                        + '                </div>'
                                        + '            </div>'
                                        + '        </div>'
                                        + '    </div>'
                                        + '</div>';
                                    
                                    document.getElementById("donations_add__list").innerHTML = html;
                                } else {
                                    document.getElementById("donations_add__list").innerHTML = "";
                                }
                                
                                if (donationsActive == false) {
                                    alertOpen({
                                            title: "Warning",
                                            text: "You must add money to your account to be able to purchase license.",
                                            type: "danger",
                                            confirmButtonText: "OK",
                                            showCancelButton: false
                                        },
                                        null
                                    );
                                }
                            }
                        },
                        error: function(XMLHttpRequest, textStatus, errorThrown) {
                            var jsonResponse = JSON.parse(XMLHttpRequest.responseText);
                            
                            document.getElementById("donations_add__list").innerHTML = "";
                        }
                    });
                }
            },
            error: function(XMLHttpRequest, textStatus, errorThrown) {
                var jsonResponse = JSON.parse(XMLHttpRequest.responseText);
                console.log(jsonResponse);
            }
        });
    }
    
    function donations_add__New(contracts) {
        //document.querySelector('#formAccountProfileEdit input[name="birthdate"]').value = FormatStringDate(document.getElementById('birthdate').value);
        
        //Controller.accountsUpdate('formAccountProfileEdit');
        
        //var jsonData = JSON.parse(formToJSONString('formAccountProfileEdit'));
        
        document.getElementById("acquire--"+contracts).innerHTML = "Processing...";
        document.getElementById("acquire--"+contracts).classList.add("disabled");
        
        $.ajax({
            type: "POST",
            url: CFG__API_URL + CFG__API_VERSION + "/donations",
            data: {
                contracts: contracts
            },
            beforeSend: function (xhr){ 
                xhr.setRequestHeader('Authorization', cookieGet('__utmo'));
            },
            success: function(response) {
                if (response.success === true) {
                    //fgUpdateUserData();
                    if (router.current[0].url == "") {
                        if (typeof indexLoadData === "function") {
                            indexLoadData();
                        }
                    } else {
                        if (typeof fc__donationsGetListing === "function") {
                            fc__donationsGetListing();
                        } else {
                            if (typeof fc_walletGetListing === "function") {
                                fc_walletGetListing("*");
                            }
                        }
                    }
                    dialogClose();
                } else {
                    App.alert('Waiting', response.message, null);
                }
            },
            error: function(XMLHttpRequest, textStatus, errorThrown) {
                var jsonResponse = JSON.parse(XMLHttpRequest.responseText);
                
                App.alert('Error', 'An unexpected error occurred while requesting information.', null);
            }
        });
    }
    
    donationsAddGetAll();
</script>
